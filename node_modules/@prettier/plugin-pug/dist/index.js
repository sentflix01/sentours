import Rt from"pug-lexer";var I=(o=>(o.DEBUG="debug",o.LOG="log",o.INFO="info",o.WARN="warn",o.ERROR="error",o.OFF="off",o))(I||{}),P=class{constructor(t=console,i="info"){this.logger=t;this.level=i}static isSupportedLogLevel(t){return typeof t=="string"&&(t==="debug"||t==="log"||t==="info"||t==="warn"||t==="error"||t==="off")}setLogLevel(t){this.level=t}isDebugEnabled(){return this.level<="debug"}debug(t,...i){this.message("debug",t,...i)}log(t,...i){this.message("log",t,...i)}info(t,...i){this.message("info",t,...i)}warn(t,...i){this.message("warn",t,...i)}error(t,...i){this.message("error",t,...i)}message(t,i,...e){this.level!=="off"&&this.level<=t&&t!=="off"&&this.logger[t](i,...e)}};function _(r=console){return new P(r)}var p=_(console);process.env.NODE_ENV==="test"&&p.setLogLevel("debug");var y=process.env.PRETTIER_PLUGIN_PUG_LOG_LEVEL;y&&(y=y.toLowerCase(),P.isSupportedLogLevel(y)&&p.setLogLevel(y));var l="Pug";var E={category:l,type:"path",array:!0,default:[{value:[]}],description:""},O={...E,description:"Define a list of patterns for attributes that are sorted to the beginning."},L={...E,description:"Define a list of patterns for attributes that are sorted at the end."},C={category:l,type:"choice",default:"as-is",description:"Change how the attributes between _beginning_ and _end_ should be sorted.",choices:[{value:"asc",description:"Sort middle attributes ascending."},{value:"desc",description:"Sort middle attributes descending."},{value:"as-is",description:"Middle attributes are leave untouched."}]};var N={category:l,type:"int",default:-1,description:"The line length where Prettier will try wrap.",range:{start:-1,end:Number.POSITIVE_INFINITY,step:1}},R={category:l,type:"choice",default:null,description:"",choices:[{value:null,description:"Use `singleQuote` value."},{value:!0,description:"Use single quotes instead of double quotes."},{value:"true",description:"Use single quotes instead of double quotes."},{value:!1,description:"Use double quotes instead of double quotes."}]},U={category:l,type:"int",default:-1,description:"Number of spaces per indentation level.",range:{start:-1,end:Number.POSITIVE_INFINITY,step:1}},$={category:l,type:"choice",default:null,description:"",choices:[{value:null,description:"Use `useTabs` value."},{value:!0,description:"Indent with tabs instead of spaces."},{value:"true",description:"Indent with tabs instead of spaces."},{value:!1,description:"Indent with spaces instead of tabs."}]},B={category:l,type:"choice",default:null,description:"",choices:[{value:null,description:"Use `bracketSpacing` value."},{value:!0,description:"Print spaces between brackets."},{value:"true",description:"Print spaces between brackets."},{value:!1,description:"Do not print spaces between brackets."}]},G={category:l,type:"choice",default:null,description:"",choices:[{value:null,description:"Use `bracketSpacing` value."},{value:!0,description:"Print semicolons."},{value:"true",description:"Print semicolons."},{value:!1,description:"Do not print semicolons, except at the beginning of lines which may need them."}]},D={category:l,type:"choice",default:null,description:"Include parentheses around a sole arrow function parameter.",choices:[{value:null,description:"Use `arrowParens` value."},{value:"always",description:"Always add parens. Example: `(x) => x`"},{value:"avoid",description:"Omit parens when possible. Example: `x => x`"}]},W={category:l,type:"choice",default:null,description:"Determines position of closing bracket which wraps attributes.",choices:[{value:null,description:"Use `bracketSameLine` value."},{value:!0,description:`
			Closing bracket remains with last attribute's line.
			Example:
			input(
				type='text',
				value='my_value',
				name='my_name',
				alt='my_alt',
				autocomplete='on')
			`},{value:"true",description:`
			Closing bracket remains with last attribute's line.
			Example:
			input(
				type='text',
				value='my_value',
				name='my_name',
				alt='my_alt',
				autocomplete='on')
			`},{value:!1,description:`
			Closing bracket ends with a new line.
			Example:
			input(
				type='text',
				value='my_value',
				name='my_name',
				alt='my_alt',
				autocomplete='on'
			)
			`}]};var F={category:l,type:"choice",default:"as-is",description:"Change behavior of boolean attributes.",choices:[{value:"as-is",description:"Nothing is changed."},{value:"none",description:"Every attribute with empty quotes will have them removed."},{value:"all",description:"Every boolean attribute will be expressed with empty quotes."}]},j={category:l,type:"path",default:[{value:[]}],array:!0,description:'Define a list of patterns for attributes that will be forced to have empty quotes even with "none" selected.'};var Q={category:l,type:"choice",default:"always",description:"Change when attributes are separated by commas in tags.",choices:[{value:"always",description:'Always separate attributes with commas. Example: `button(type="submit", (click)="play()", disabled)`'},{value:"as-needed",description:'Only add commas between attributes where required. Example: `button(type="submit", (click)="play()" disabled)`'},{value:"none",description:'Never add commas between attributes. Example: `button(type="submit" @click="play()" :style="style" disabled)`'}]};function V(r){switch(r){case"always":case"as-needed":case"none":return r}throw new Error(`Invalid option for pugAttributeSeparator. Found '${r}'. Possible options: 'always', 'as-needed' or 'none'`)}var M={category:l,type:"choice",default:"before-attributes",description:"Define where classes be placed.",choices:[{value:"before-attributes",description:"Forces all valid class literals to be placed before attributes."},{value:"after-attributes",description:"Forces all valid class literals to be placed after attributes."}]};var Y={category:l,type:"choice",default:"literal",description:"Define how classes should be formatted.",choices:[{value:"literal",description:"Forces all valid classes to be printed as literals."},{value:"attribute",description:"Forces all valid classes to be printed in class attribute."},{value:"as-is",description:"Disables class formatting."}]};var q={category:l,type:"choice",default:0,description:"Determines the indent level of closing brackets when wrapping attributes.",choices:[{value:0,description:`
			Closing bracket aligns with the element.
			Example:
			input(
				type='text',
				value='my_value',
				name='my_name',
				alt='my_alt',
				autocomplete='on'
			)
			`},{value:1,description:`
			Closing bracket aligns with the element's attributes.
			Example:
			input(
				type='text',
				value='my_value',
				name='my_name',
				alt='my_alt',
				autocomplete='on'
				)
			`}]};var H={category:l,type:"choice",default:"keep-all",description:"Change behavior of spaces within comments.",choices:[{value:"keep-all",description:"Keep all spaces within comments. Example: `//    this  is   a   comment`"},{value:"keep-leading",description:"Keep leading spaces within comments. Example: `//    this is a comment`"},{value:"trim-all",description:"Trim all spaces within comments. Example: `// this is a comment`"}]};function A(r,t,i=!1){switch(t){case"keep-leading":{let e="",n=0;for(n;n<r.length&&r[n]===" ";n++)e+=" ";return e+=r.slice(n).trim().replaceAll(/\s\s+/g," "),e}case"trim-all":{let e=r.trim();return e=e.replaceAll(/\s\s+/g," "),!i&&r[0]===" "&&(e=` ${e}`),e}case"keep-all":default:return r}}var K={category:l,type:"boolean",default:!1,description:"Include `div` tag when followed by literal class or id syntax"};var J={category:l,type:"choice",default:"auto",description:"Define which framework is used in the project.",choices:[{value:"auto",description:"Try to identify used framework, if there is one."},{value:"vue",description:"Uses Vue.js."},{value:"svelte",description:"Uses Svelte."},{value:"angular",description:"Uses Angular."}]};var z={category:l,type:"choice",default:"literal",description:"Define how the id should be formatted.",choices:[{value:"literal",description:"Forces all valid ids to be printed as literals."},{value:"as-is",description:"Disables id formatting."}]};var X={category:l,type:"boolean",default:!1,description:"Preserve attribute brackets."};var Z={category:l,type:"boolean",default:!0,description:"Preserve additional whitespace in text."};var tt={category:l,type:"boolean",default:!1,description:"Indent pug in template tags in single file components such as from vue or svelte."};var et={category:l,type:"int",default:-1,description:"The maximum amount of attributes that an element can appear with on one line before it gets wrapped.",range:{start:-1,end:Number.POSITIVE_INFINITY,step:1}},it={category:l,type:"path",default:"",description:"Regex pattern to match attributes against that should always trigger wrapping."};var rt={pugPrintWidth:N,pugSingleQuote:R,pugTabWidth:U,pugUseTabs:$,pugBracketSpacing:B,pugArrowParens:D,pugSemi:G,pugBracketSameLine:W,pugClosingBracketIndentDepth:q,pugAttributeSeparator:Q,pugCommentPreserveSpaces:H,pugSortAttributes:C,pugSortAttributesBeginning:O,pugSortAttributesEnd:L,pugWrapAttributesThreshold:et,pugWrapAttributesPattern:it,pugEmptyAttributes:F,pugClassNotation:Y,pugIdNotation:z,pugClassLocation:M,pugExplicitDiv:K,pugEmptyAttributesForceQuotes:j,pugSingleFileComponentIndentation:tt,pugFramework:J,pugPreserveAttributeBrackets:X,pugPreserveWhitespace:Z};function nt(r){return{printWidth:r.printWidth,pugPrintWidth:r.pugPrintWidth===-1?r.printWidth:r.pugPrintWidth,singleQuote:r.singleQuote,pugSingleQuote:r.pugSingleQuote??r.singleQuote,tabWidth:r.tabWidth,pugTabWidth:r.pugTabWidth===-1?r.tabWidth:r.pugTabWidth,useTabs:r.useTabs??!1,pugUseTabs:r.pugUseTabs??r.useTabs??!1,bracketSpacing:r.bracketSpacing,pugBracketSpacing:r.pugBracketSpacing??r.bracketSpacing,arrowParens:r.arrowParens,pugArrowParens:r.pugArrowParens??r.arrowParens,semi:r.semi,pugSemi:r.pugSemi??r.semi,bracketSameLine:r.bracketSameLine,pugBracketSameLine:r.pugBracketSameLine??r.bracketSameLine,pugAttributeSeparator:r.pugAttributeSeparator,pugCommentPreserveSpaces:r.pugCommentPreserveSpaces,pugSortAttributes:r.pugSortAttributes,pugSortAttributesBeginning:r.pugSortAttributesBeginning,pugSortAttributesEnd:r.pugSortAttributesEnd,pugWrapAttributesThreshold:r.pugWrapAttributesThreshold,pugWrapAttributesPattern:r.pugWrapAttributesPattern,pugClassNotation:r.pugClassNotation,pugIdNotation:r.pugIdNotation,pugClassLocation:r.pugClassLocation,pugEmptyAttributes:r.pugEmptyAttributes,pugEmptyAttributesForceQuotes:r.pugEmptyAttributesForceQuotes,pugSingleFileComponentIndentation:r.pugSingleFileComponentIndentation&&r.__embeddedInHtml===!0,pugFramework:r.pugFramework,pugExplicitDiv:r.pugExplicitDiv,pugPreserveAttributeBrackets:r.pugPreserveAttributeBrackets,pugPreserveWhitespace:r.pugPreserveWhitespace,pugClosingBracketIndentDepth:r.pugClosingBracketIndentDepth??0}}import{types as Nt}from"node:util";import{format as g}from"prettier";var st={"<!doctype html>":"doctype html",'<?xml version="1.0" encoding="utf-8" ?>':"doctype xml",'<!doctype html public "-//w3c//dtd xhtml 1.0 transitional//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-transitional.dtd">':"doctype transitional",'<!doctype html public "-//w3c//dtd xhtml 1.0 strict//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-strict.dtd">':"doctype strict",'<!doctype html public "-//w3c//dtd xhtml 1.0 frameset//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-frameset.dtd">':"doctype frameset",'<!doctype html public "-//w3c//dtd xhtml 1.1//en" "http://www.w3.org/tr/xhtml11/dtd/xhtml11.dtd">':"doctype 1.1",'<!doctype html public "-//w3c//dtd xhtml basic 1.1//en" "http://www.w3.org/tr/xhtml-basic/xhtml-basic11.dtd">':"doctype basic",'<!doctype html public "-//wapforum//dtd xhtml mobile 1.2//en" "http://www.openmobilealliance.org/tech/dtd/xhtml-mobile12.dtd">':"doctype mobile",'<!doctype plist public "-//apple//dtd plist 1.0//en" "http://www.apple.com/dtds/propertylist-1.0.dtd">':"doctype plist"};function ot(r,t,i,e,n){let s=e.map(d=>new RegExp(d)).reverse(),o=n.map(d=>new RegExp(d)),a=r.name,u=t.name;if(s.length>0){let d=s.findIndex(f=>f.test(a)),c=s.findIndex(f=>f.test(u)),h=d-c;if(h>0)return-1;if(h<0)return 1}if(o.length>0){let d=o.findIndex(f=>f.test(a)),c=o.findIndex(f=>f.test(u)),h=d-c;if(h>0)return 1;if(h<0)return-1}switch(i){case"asc":{if(a>u)return 1;if(a<u)return-1;break}case"desc":{if(a>u)return-1;if(a<u)return 1;break}}return 0}function _t(r,t){let i=r.map((e,n)=>[e,n]);return i.sort((e,n)=>{let s=t(e[0],n[0]);return s===0?e[1]-n[1]:s}),i.map(([e])=>e)}function at(r,t,i,e){let n=r.slice(0,t),s=r.slice(i),o=r.slice(t,i),a=_t(o,e);return[...n,...a,...s]}var Et=new Set([!0,'""',"''"]);function pt(r,t,i){let{val:e,name:n}=r;if(i.map(a=>new RegExp(a)).some(a=>a.test(n))){r.val===!0&&(r.val='""');return}if(!(t==="as-is"||!Et.has(e)))switch(t){case"all":{r.val===!0&&(r.val='""');break}case"none":{(r.val==='""'||r.val==="''")&&(r.val=!0);break}}}function lt(r,t){for(let i=t-1;i>=0;i--){let e=r[i];if(!e)return;if(e.type==="tag")return e}}function ut(r,t){for(let i=t-1;i>0;i--){let e=r[i];if(!e||e.type==="start-attributes")return;if(e.type==="attribute"&&e.name!=="class"&&e.name!=="id")return e}}function ct(r,t){for(let i=t-1;i>0;i--){let e=r[i];if(!e||e.type==="start-attributes"||e.type==="tag")return;if(e.type==="attribute"&&e.name==="type")return e}}function T(r){return r.includes(`
`)?r.split(`
`).map(t=>t.trim()).map(t=>(t[0]==="."?"":" ")+t).join("").trim():r}function gt(r,t){return r==="style"&&m(t)}function k(r,t,i,e=0){return r.startsWith(t,e)&&r.endsWith(i,r.length-e)}function m(r){return/^(["'`])(.*)\1$/.test(r)?!new RegExp(`${r[0]}(?<!\\\\${r[0]})`).test(r.slice(1,-1)):!1}function dt(r){return/^`[\S\s]*`$/.test(r)&&r.includes("${")}function ht(r){return/^`[\S\s]*`$/m.test(r)&&r.includes(`
`)}function b(r,t,[i,e]=["{{","}}"]){return r?`${i} ${t} ${e}`:`${i}${t}${e}`}function x(r,t,i=!1){let e=t==='"'?"'":'"',n=r.replaceAll(/\\([\S\s])|(["'])/g,(s,o,a)=>o===e?o:a===t?`\\${a}`:a||(i&&/^[^\n\r"'0-7\\bfnrt-vx\u2028\u2029]$/.test(o)?o:`\\${o}`));return t+n+t}function w(r,t,i,e){let n=r.indexOf(t),s=r.indexOf(i),o=r.indexOf("`");return n>=0&&s>=0&&s>n&&(o<0||n<o)?(e.log({code:r,quotes:t,otherQuotes:i,q1:n,q2:s,qb:o}),!0):!1}function mt(){try{let r=Object.keys(process.env).filter(t=>t.startsWith("npm_package_")).filter(t=>/(dev)?[Dd]ependencies_+/.test(t));if(r.some(t=>t.includes("vue")&&!t.includes("vuepress")))return"vue";if(r.some(t=>t.includes("svelte")))return"svelte";if(r.some(t=>t.includes("angular")))return"angular"}catch{return"auto"}return"auto"}function ft(r){return r.length>=3&&r[0]==="["&&r.at(-1)==="]"}function bt(r){return r.length>=3&&r[0]==="("&&r.at(-1)===")"}function Tt(r){return r.length>=2&&r[0]==="*"}function yt(r){return r.length>=5&&m(r)&&k(r,"{{","}}",1)&&!r.includes("{{",3)}var Ot=/\+(json|yaml)$/i,Lt=/(^(["'`]))|((["'`])$)/g,Ct=new Map([["application/ecmascript","babel"],["application/javascript","babel"],["application/json","json"],["text/ecmascript","babel"],["text/javascript","babel"],["text/markdown","markdown"],["text/typescript","typescript"],["module","babel"]]);function Pt(r){if(!r)return"babel";let t=r.val;if(typeof t!="string")return;let i=t.replaceAll(Lt,"");if(!i)return"babel";let e=Ot.exec(i);return e?e[1]:Ct.get(i)}function vt(r){return r.length>=3&&m(r)&&k(r,"{","}",1)&&!r.includes("{",2)}function kt(r){return/^(v-on:|@).*/.test(r)}function xt(r){return/^((v-(bind|slot))?:|v-(model|slot|if|for|else-if|text|html|t)|#).*/.test(r)}function St(r,t){return r==="v-for"&&t.includes("of")}function At(r){return r==="v-bind"}function wt(r){return r==="v-on"}function It(r){return r.startsWith("v-")}var S=class{constructor(t,i,e){this.content=t;this.tokens=i;this.options=e;this.indentString=e.pugUseTabs?"	":" ".repeat(e.pugTabWidth),e.pugSingleFileComponentIndentation&&this.indentLevel++,this.framework=e.pugFramework==="auto"?mt():e.pugFramework,this.quotes=this.options.pugSingleQuote?"'":'"',this.otherQuotes=this.options.pugSingleQuote?'"':"'";let n=V(e.pugAttributeSeparator);this.alwaysUseAttributeSeparator=n==="always",this.neverUseAttributeSeparator=n==="none";let s=e.pugWrapAttributesPattern;this.wrapAttributesPattern=s?new RegExp(s):null,this.codeInterpolationOptions={semi:e.pugSemi??e.semi,singleQuote:e.pugSingleQuote??e.singleQuote,bracketSpacing:e.pugBracketSpacing??e.bracketSpacing,arrowParens:e.pugArrowParens??e.arrowParens,printWidth:9e3,endOfLine:"lf",useTabs:e.pugUseTabs??e.useTabs,tabWidth:e.pugTabWidth??e.tabWidth,bracketSameLine:e.pugBracketSameLine??e.bracketSameLine}}result="";currentIndex=-1;currentLineLength=0;indentString;indentLevel=0;framework="auto";quotes;otherQuotes;alwaysUseAttributeSeparator;neverUseAttributeSeparator;wrapAttributesPattern;codeInterpolationOptions;currentTagPosition=0;possibleIdPosition=0;possibleClassPosition=0;previousAttributeRemapped=!1;wrapAttributes=!1;pipelessText=!1;pipelessComment=!1;currentlyInPugInterpolation=!1;classLiteralToAttribute=[];classLiteralAfterAttributes=[];get computedIndent(){switch(this.previousToken?.type){case"newline":case"outdent":return this.indentString.repeat(this.indentLevel);case"indent":return this.indentString;case"start-pug-interpolation":return""}return this.options.pugSingleFileComponentIndentation?this.indentString:""}get previousToken(){return this.tokens[this.currentIndex-1]}get nextToken(){return this.tokens[this.currentIndex+1]}async build(){p.isDebugEnabled()&&p.debug("[PugPrinter:build]:",JSON.stringify(this.tokens));let t=[];if(this.tokens[0]?.type==="text")t.push("| ");else if(this.tokens[0]?.type==="eos")return"";let i=this.getNextToken();for(;i;){p.debug("[PugPrinter:build]:",JSON.stringify(i));try{switch(i.type){case"attribute":case"class":case"end-attributes":case"id":case"eos":{this.result=t.join(""),await this[i.type](i),t.length=0,t.push(this.result);break}case"tag":case"start-attributes":case"interpolation":case"call":case":":this.result=t.join("");default:{if(typeof this[i.type]!="function")throw new Error("Unhandled token: "+JSON.stringify(i));t.push(await this[i.type](i));break}}}catch(e){throw new Error(e)}i=this.getNextToken()}return t.join("")}getNextToken(){return this.currentIndex++,this.tokens[this.currentIndex]??null}quoteString(t){return`${this.quotes}${t}${this.quotes}`}checkTokenType(t,i,e=!1){return!!t&&i.includes(t.type)!==e}tokenNeedsSeparator(t){return this.neverUseAttributeSeparator?!1:this.alwaysUseAttributeSeparator||/^([(:[]).*/.test(t.name)}getUnformattedContentLines(t,i){let{start:e}=t.loc,{end:n}=i.loc,s=this.content.split(/\r\n|\n|\r/),o=e.line-1,a=n.line-1,u=[],d=s[o];d!==void 0&&u.push(d.slice(e.column-1));for(let h=o+1;h<a;h++){let f=s[h];f!==void 0&&u.push(f)}let c=s[a];return c!==void 0&&u.push(c.slice(0,n.column-1)),u}replaceTagWithLiteralIfPossible(t,i){if(this.options.pugExplicitDiv)return;let e=Math.max(this.possibleIdPosition,this.possibleClassPosition),n=this.result.slice(this.currentTagPosition,e),s=n.replace(t,i);if(s!==n){let o=this.result.slice(0,this.currentTagPosition),a=this.result.slice(e);this.result=`${o}${s}${a}`;let u=n.length-s.length;this.possibleIdPosition-=u,this.possibleClassPosition-=u}}async frameworkFormat(t){let i={...this.codeInterpolationOptions,singleQuote:this.options.singleQuote};switch(this.framework){case"angular":{i.parser="__ng_interpolation";break}case"svelte":case"vue":default:i.parser="babel",i.semi=!1}let e=await g(t,i);return e[0]===";"&&(e=e.slice(1)),e}async formatText(t){let i="";for(;t;){let e=t.indexOf("{{");if(e===-1){let n=t.indexOf("{");if(this.options.pugFramework==="svelte"&&n!==-1){i+=t.slice(0,n),t=t.slice(n+1);let s=t.indexOf("}");if(s===-1)i+="{",i+=t,t="";else{let o=t.slice(0,s);try{if(w(o,this.quotes,this.otherQuotes,p)){p.warn("The following expression could not be formatted correctly. Please try to fix it yourself and if there is a problem, please open a bug issue:",o),i+=b(this.options.pugBracketSpacing,o),t=t.slice(s+1);continue}else o=await this.frameworkFormat(o)}catch(a){p.warn("[PugPrinter:formatText]: ",a);try{o=await g(o,{parser:"babel",...this.codeInterpolationOptions,semi:!1}),o[0]===";"&&(o=o.slice(1))}catch(u){p.warn(u)}}o=T(o),i+=b(this.options.pugBracketSpacing,o,["{","}"]),t=t.slice(s+1)}}else i+=t,t=""}else{i+=t.slice(0,e),t=t.slice(e+2);let n=t.indexOf("}}");if(n===-1)i+="{{",i+=t,t="";else{let s=t.slice(0,n);try{if(w(s,this.quotes,this.otherQuotes,p)){p.warn("The following expression could not be formatted correctly. Please try to fix it yourself and if there is a problem, please open a bug issue:",s),i+=b(this.options.pugBracketSpacing,s),t=t.slice(n+2);continue}else s=await this.frameworkFormat(s)}catch(o){typeof o=="string"?o.includes("Unexpected token Lexer Error")?o.includes("Unexpected character [`]")||p.debug("[PugPrinter:formatText]: Using fallback strategy"):o.includes("Bindings cannot contain assignments")?p.warn("[PugPrinter:formatText]: Bindings should not contain assignments:",`code: \`${s.trim()}\``):o.includes("Unexpected token '('")?this.framework!=="vue"&&p.warn("[PugPrinter:formatText]: Found unexpected token `(`.",`code: \`${s.trim()}\``):o.includes("Missing expected `)`")?this.framework!=="vue"&&p.warn("[PugPrinter:formatText]: Missing expected `)`.",`code: \`${s.trim()}\``):o.includes("Missing expected `:`")?this.framework!=="vue"&&p.warn("[PugPrinter:formatText]: Missing expected `:`.",`code: \`${s.trim()}\``):p.warn("[PugPrinter:formatText]: ",o):p.warn("[PugPrinter:formatText]: ",o);try{s=await g(s,{parser:"babel",...this.codeInterpolationOptions,semi:!1}),s[0]===";"&&(s=s.slice(1))}catch(a){p.warn(a)}}s=T(s),i+=b(this.options.pugBracketSpacing,s),t=t.slice(n+2)}}}return i}async formatDelegatePrettier(t,i,e={}){let{trimTrailingSemicolon:n=!1,trimLeadingSemicolon:s=!0}=e,o={...this.codeInterpolationOptions};t=t.trim();let a=m(t);return a&&(o.singleQuote=!this.options.pugSingleQuote,t=t.slice(1,-1)),t=await g(t,{parser:i,...o}),t=T(t),n&&t.at(-1)===";"&&(t=t.slice(0,-1)),s&&t[0]===";"&&(t=t.slice(1)),a&&(t=this.quotes==='"'?t=t.replaceAll(/(?<!\\)((?:\\\\)*)"/g,'$1\\"'):t=t.replaceAll("'","\\'"),t=this.quoteString(t)),t}async formatStyleAttribute(t){return this.formatDelegatePrettier(t,"css",{trimTrailingSemicolon:!0})}async formatVueEventBinding(t){try{return await this.formatDelegatePrettier(t,"__vue_event_binding",{trimTrailingSemicolon:!0})}catch{return this.formatVueTsEventBinding(t)}}async formatVueTsEventBinding(t){return this.formatDelegatePrettier(t,"__vue_ts_event_binding",{trimTrailingSemicolon:!0})}async formatVueExpression(t){try{return await this.formatDelegatePrettier(t,"__vue_expression")}catch{return this.formatVueTsExpression(t)}}async formatVueTsExpression(t){return this.formatDelegatePrettier(t,"__vue_ts_expression")}async formatAngularBinding(t){return this.formatDelegatePrettier(t,"__ng_binding")}async formatAngularAction(t){return this.formatDelegatePrettier(t,"__ng_action")}async formatAngularDirective(t){return this.formatDelegatePrettier(t,"__ng_directive")}async formatFrameworkInterpolation(t,i,[e,n]){if(t=t.slice(1,-1),t=t.slice(e.length,-n.length),t=t.trim(),t.includes(`\\${this.otherQuotes}`))p.warn("The following expression could not be formatted correctly. Please try to fix it yourself and if there is a problem, please open a bug issue:",t);else{let s={...this.codeInterpolationOptions,singleQuote:!this.options.pugSingleQuote};try{t=await g(t,{parser:i,...s})}catch{p.warn("The following expression could not be formatted correctly. Please try to fix it yourself and if there is a problem, please open a bug issue:",t)}t=T(t)}return t=b(this.options.pugBracketSpacing,t,[e,n]),this.quoteString(t)}async formatAngularInterpolation(t){return this.formatFrameworkInterpolation(t,"__ng_interpolation",["{{","}}"])}async formatSvelteInterpolation(t){return this.formatFrameworkInterpolation(t,"__ng_interpolation",["{","}"])}tag(t){let i=t.val;i==="div"&&!this.options.pugExplicitDiv&&this.nextToken&&(this.nextToken.type==="class"&&this.options.pugClassLocation==="before-attributes"||this.nextToken.type==="id")&&(i=""),this.currentLineLength+=i.length;let e=`${this.computedIndent}${i}`;return p.debug("tag",{result:e,val:t.val,length:t.val.length},this.currentLineLength),this.currentTagPosition=this.result.length+this.computedIndent.length,this.possibleIdPosition=this.result.length+e.length,this.possibleClassPosition=this.result.length+e.length,e}"start-attributes"(t){let i="";if(this.nextToken?.type==="attribute"){this.previousAttributeRemapped=!1,this.possibleClassPosition=this.result.length,i="(",p.debug(this.currentLineLength);let e=this.nextToken,n=this.currentIndex+1,s=!1,o=0;for(;e.type==="attribute";){switch(!this.currentlyInPugInterpolation&&!this.wrapAttributes&&this.wrapAttributesPattern?.test(e.name)&&(this.wrapAttributes=!0),e.name){case"class":case"id":{(e.name==="class"&&this.options.pugClassNotation!=="literal"||e.name==="id"&&this.options.pugIdNotation!=="literal")&&o++,s=!0;let a=e.val.toString();m(a)&&(this.currentLineLength-=2),this.currentLineLength+=1+a.length,p.debug({tokenName:e.name,length:e.name.length},this.currentLineLength);break}default:{this.currentLineLength+=e.name.length,o>0&&(this.currentLineLength+=1,this.tokenNeedsSeparator(e)&&(this.currentLineLength+=1)),p.debug({tokenName:e.name,length:e.name.length},this.currentLineLength);let a=e.val.toString();a.length>0&&a!=="true"&&(this.currentLineLength+=1+a.length,p.debug({tokenVal:a,length:a.length},this.currentLineLength)),o++;break}}e=this.tokens[++n]}if(p.debug("after token",this.currentLineLength),s&&this.previousToken?.type==="tag"&&this.previousToken.val==="div"&&!this.options.pugExplicitDiv&&(this.currentLineLength-=3),o>0&&(this.currentLineLength+=2),this.options.pugClassLocation==="after-attributes"){let a=n,u=this.tokens[++a];for(;u.type==="class";){let d=u.val.toString();this.currentLineLength+=1+d.length,p.debug({tokenVal:d,length:d.length},this.currentLineLength),u=this.tokens[++a]}}if(p.debug("final line length",{currentLineLength:this.currentLineLength}),!this.currentlyInPugInterpolation&&!this.wrapAttributes&&(this.currentLineLength>this.options.pugPrintWidth||this.options.pugWrapAttributesThreshold>=0&&o>this.options.pugWrapAttributesThreshold)&&(this.wrapAttributes=!0),this.options.pugSortAttributes!=="as-is"||this.options.pugSortAttributesEnd.length>0||this.options.pugSortAttributesBeginning.length>0){let a=this.tokens.indexOf(t),u=n;u-a>2&&(this.tokens=at(this.tokens,a+1,u,(d,c)=>ot(d,c,this.options.pugSortAttributes,this.options.pugSortAttributesBeginning,this.options.pugSortAttributesEnd)))}}return i}async attribute(t){if(pt(t,this.options.pugEmptyAttributes,this.options.pugEmptyAttributesForceQuotes),typeof t.val=="string"&&m(t.val)&&t.val[0]!=="`"){if(t.name==="class"&&this.options.pugClassNotation==="literal"){let n=t.val.slice(1,-1).trim().split(/\s+/),s=[],o=[],a=/^-?[A-Z_a-z]+[\w-]*$/;for(let u of n)a.test(u)?this.options.pugClassLocation==="after-attributes"?this.classLiteralAfterAttributes.push(u):o.push(u):s.push(u);if(o.length>0){let u=this.possibleClassPosition;this.result=[this.result.slice(0,u),".",o.join("."),this.result.slice(u)].join(""),this.possibleClassPosition+=1+o.join(".").length,this.options.pugClassLocation==="before-attributes"&&this.replaceTagWithLiteralIfPossible(/div\./,".")}if(s.length>0)t.val=x(s.join(" "),this.quotes),this.previousAttributeRemapped=!1;else{this.previousAttributeRemapped=!0;return}}else if(t.name==="id"&&this.options.pugIdNotation!=="as-is"){let e=t.val;if(e=e.slice(1,-1),e=e.trim(),!/^-?[A-Z_a-z]+[\w-]*$/.test(e)){e=x(e,this.quotes),this.result+="id",t.mustEscape||(this.result+="!"),this.result+=`=${e}`;return}let s=this.possibleIdPosition,o=`#${e}`;this.result=[this.result.slice(0,s),o,this.result.slice(s)].join(""),this.possibleClassPosition+=o.length,this.replaceTagWithLiteralIfPossible(/div#/,"#"),this.previousAttributeRemapped=!0;return}}let i=ut(this.tokens,this.currentIndex);if(this.previousToken?.type==="attribute"&&(!this.previousAttributeRemapped||i)&&(this.tokenNeedsSeparator(t)&&(this.result+=","),this.wrapAttributes||(this.result+=" ")),this.previousAttributeRemapped=!1,this.wrapAttributes&&(this.result+=`
`,this.result+=this.indentString.repeat(this.indentLevel+1)),this.result+=t.name,typeof t.val=="boolean")t.val||(this.result+=`=${t.val}`);else if(t.name==="class"&&this.options.pugClassNotation==="attribute"){let n=(m(t.val)?t.val.slice(1,-1).trim():t.val).split(/\s+/);if(this.classLiteralToAttribute.length>0)for(let s=this.classLiteralToAttribute.length-1;s>-1;s--){let o=this.classLiteralToAttribute.splice(s,1)[0];o&&n.unshift(o)}this.result+=`=${m(t.val)?this.quoteString(n.join(" ")):n.join(" ")}`}else{let e=t.val;if(!ht(e)){if(!dt(e))if(St(t.name,e))e=await this.formatDelegatePrettier(e,"vue");else if(xt(t.name))e=await this.formatVueExpression(e);else if(kt(t.name))e=await this.formatVueEventBinding(e);else if(this.framework==="vue"&&It(t.name))e=await this.formatVueExpression(e);else if(At(t.name))e=await this.formatDelegatePrettier(e,"__js_expression");else if(wt(t.name))e=await this.formatDelegatePrettier(e,"__js_expression");else if(ft(t.name))e=await this.formatAngularBinding(e);else if(bt(t.name))e=await this.formatAngularAction(e);else if(Tt(t.name))e=await this.formatAngularDirective(e);else if(yt(e))e=await this.formatAngularInterpolation(e);else if(vt(e))e=await this.formatSvelteInterpolation(e);else if(gt(t.name,t.val))e=await this.formatStyleAttribute(e);else{let n=e.trimEnd();if(m(n))e=x(n.slice(1,-1),this.quotes);else{if(e==="true")return;if(t.mustEscape){e=await g(e,{parser:"__js_expression",...this.codeInterpolationOptions});let s=e.split(`
`),o=this.wrapAttributes?this.indentLevel+1:this.indentLevel;if(s.length>1){e=s[0]??"";for(let a=1;a<s.length;a++)e+=`
`,e+=this.indentString.repeat(o),e+=s[a]}}else e=e.trim(),e=e.replaceAll(/\s\s+/g," "),e[0]==="{"&&e[1]===" "&&(e=`{${e.slice(2)}`)}}}t.mustEscape||(this.result+="!"),this.result+=`=${e}`}}"end-attributes"(t){if(this.wrapAttributes&&this.result.at(-1)!=="("&&(this.options.pugBracketSameLine||(this.result+=`
`),this.result+=this.indentString.repeat(this.indentLevel+this.options.pugClosingBracketIndentDepth)),this.wrapAttributes=!1,this.classLiteralToAttribute.length>0){this.previousToken?.type==="start-attributes"?this.result+="(":this.previousToken?.type==="attribute"&&(this.result+=" ");let i=this.classLiteralToAttribute.splice(0);this.result+=`class=${this.quoteString(i.join(" "))}`,this.previousToken?.type==="start-attributes"&&(this.result+=")")}if(this.result.at(-1)==="("?this.result=this.result.slice(0,-1):this.previousToken?.type==="attribute"?(this.options.pugBracketSameLine&&(this.result=this.result.trimEnd()),this.result+=")"):this.options.pugPreserveAttributeBrackets&&this.previousToken?.type==="start-attributes"&&(this.result+="()"),this.result.at(-1)===")"&&this.classLiteralAfterAttributes.length>0){let i=this.classLiteralAfterAttributes.splice(0);this.result+=`.${i.join(".")}`}this.options.pugClassLocation==="after-attributes"&&(this.possibleClassPosition=this.result.length),(this.nextToken?.type==="text"||this.nextToken?.type==="path")&&(this.result+=" ")}indent(t){let i=`
${this.indentString.repeat(this.indentLevel)}`;return this.indentLevel++,this.currentLineLength=i.length-1+1+this.options.pugTabWidth,p.debug("indent",{result:i,indentLevel:this.indentLevel,pugTabWidth:this.options.pugTabWidth},this.currentLineLength),i}outdent(t){let i="";return this.previousToken&&this.previousToken.type!=="outdent"&&(t.loc.start.line-this.previousToken.loc.end.line>1&&(i+=`
`),i+=`
`),this.indentLevel--,this.currentLineLength=1+this.indentString.repeat(this.indentLevel).length,p.debug("outdent",{result:i,indentLevel:this.indentLevel},this.currentLineLength),i}class(t){if(this.options.pugClassNotation==="attribute"){if(this.classLiteralToAttribute.push(t.val),(this.previousToken===void 0||this.checkTokenType(this.previousToken,["tag","class","end-attributes"],!0)||this.previousToken.type==="tag"&&this.previousToken.val==="div"&&this.nextToken?.type!=="attribute"&&!this.options.pugExplicitDiv)&&(this.result+=`${this.computedIndent}div`),this.checkTokenType(this.nextToken,["text","newline","indent","outdent","eos",":"])){let i=this.classLiteralToAttribute.splice(0);if(this.result.at(-1)===")"){let e=this.result.lastIndexOf("("),n=this.result.indexOf("class=",e);n>-1?this.result=[this.result.slice(0,n+7),i.join(" ")," ",this.result.slice(n+7)].join(""):this.result=this.result.slice(0,-1)+`${this.neverUseAttributeSeparator?" ":", "}class=${this.quoteString(i.join(" "))})`}else this.result+=`(class=${this.quoteString(i.join(" "))})`;this.nextToken?.type==="text"&&(this.result+=" ")}}else{let i=`.${t.val}`;switch(this.currentLineLength+=i.length,p.debug("before class",{result:this.result,val:i,length:i.length,previousToken:this.previousToken},this.currentLineLength),this.previousToken?.type){case void 0:case"newline":case"outdent":case"indent":{let e=this.options.pugExplicitDiv||this.options.pugClassLocation==="after-attributes"?"div":"",n=`${this.computedIndent}${e}`;this.options.pugClassLocation==="after-attributes"?this.classLiteralAfterAttributes.push(i.slice(1)):n+=i,this.currentLineLength+=e.length,this.possibleIdPosition=this.result.length+this.computedIndent.length+e.length,this.result+=n,this.possibleClassPosition=this.result.length;break}case"end-attributes":{let e=this.result.slice(0,this.possibleClassPosition);this.result=[e,i,this.result.slice(this.possibleClassPosition)].join(""),this.possibleClassPosition+=i.length;break}default:{if(this.options.pugClassLocation==="after-attributes")this.classLiteralAfterAttributes.push(i.slice(1));else{let e=this.result.slice(0,this.possibleClassPosition);this.result=[e,i,this.result.slice(this.possibleClassPosition)].join(""),this.possibleClassPosition+=i.length}break}}if(this.options.pugClassLocation==="after-attributes"&&this.classLiteralAfterAttributes.length>0){let e=this.result.slice(0,this.possibleClassPosition);if(["text","newline","indent","outdent","eos","code",":",void 0].includes(this.nextToken?.type)){let n=this.classLiteralAfterAttributes.splice(0);e+="."+n.join(".")}this.result=[e,this.result.slice(this.possibleClassPosition)].join(""),this.possibleClassPosition=this.result.length,this.replaceTagWithLiteralIfPossible(/div\./,".")}p.debug("after class",{result:this.result,val:i,length:i.length},this.currentLineLength),this.nextToken?.type==="text"&&!/^\s+$/.test(this.nextToken.val)&&(this.currentLineLength+=1,this.result+=" ")}}eos(t){for(;this.result.at(-1)===`
`;)this.result=this.result.slice(0,-1);this.result+=`
`}comment(t){let i=this.computedIndent;if(/^ prettier-ignore($|[ :])/.test(t.val)){let e=this.getNextToken();if(e){let n=e.type==="newline",s=0;for(;e;){let{type:o}=e;if(o==="newline"&&s===0)if(n)n=!1;else break;else if(o==="indent")s++;else if(o==="outdent"){if(s--,s<=0){s<0&&this.indentLevel--;break}}else if(o==="eos")break;e=this.getNextToken()}if(e){let o=this.getUnformattedContentLines(t,e),a=o.pop();a!==void 0&&o.push(a.trimEnd()),i+=o.join(`
`),e.type==="eos"&&(i+=`
`)}}}else this.checkTokenType(this.previousToken,["newline","indent","outdent"],!0)&&(i+=" "),i+="//",t.buffer||(i+="-"),i+=A(t.val,this.options.pugCommentPreserveSpaces),this.nextToken?.type==="start-pipeless-text"&&(this.pipelessComment=!0);return i}newline(t){let i="";return this.previousToken&&t.loc.start.line-this.previousToken.loc.end.line>1&&(i+=`
`),i+=`
`,this.currentLineLength=1+this.indentString.repeat(this.indentLevel).length,p.debug("newline",{result:i,indentLevel:this.indentLevel},this.currentLineLength),i}async text(t){let i="",e=t.val,n=!1,s=e.at(-1)===" "&&!/^\s+$/.test(e);if(this.pipelessText){switch(this.previousToken?.type){case"newline":{e.trim().length>0&&(i+=this.indentString.repeat(this.indentLevel+1));break}case"start-pipeless-text":{i+=this.indentString;break}}this.pipelessComment&&(e=A(e,this.options.pugCommentPreserveSpaces,!0))}else{if(this.nextToken&&s)switch(this.nextToken.type){case"interpolated-code":case"start-pug-interpolation":{n=!0;break}}switch(e=e.replaceAll(/\s\s+/g," "),this.previousToken?.type){case"newline":{i+=this.indentString.repeat(this.indentLevel),this.options.pugPreserveWhitespace&&/^ .+$/.test(e)&&(i+=`|
`,i+=this.indentString.repeat(this.indentLevel)),i+="|",(/.*\S.*/.test(t.val)||this.nextToken?.type==="start-pug-interpolation")&&(i+=" ");break}case"indent":case"outdent":{i+=this.computedIndent,this.options.pugPreserveWhitespace&&/^ .+$/.test(e)&&(i+=`|
`,i+=this.indentString.repeat(this.indentLevel)),i+="|",(/.*\S.*/.test(t.val)||this.nextToken?.type==="start-pug-interpolation")&&(i+=" ");break}case"interpolated-code":case"end-pug-interpolation":{/^ .+$/.test(e)||e===" "?i+=" ":/^.+ $/.test(e)&&(n=!0);break}}e=e.trim(),e=await this.formatText(e),e=e.replaceAll(/#([[{])/g,"\\#$1")}return this.checkTokenType(this.previousToken,["tag","id","interpolation","call","&attributes","filter"])&&(e.length===0&&this.nextToken?.type==="indent"?s=!1:e=` ${e}`),i+=e,n&&(i+=" "),s&&this.nextToken?.type==="indent"&&(i+=`
`+this.indentString.repeat(this.indentLevel+1)+"|"),i}"interpolated-code"(t){let i="";switch(this.previousToken?.type){case"tag":case"class":case"id":case"end-attributes":{i=" ";break}case"start-pug-interpolation":{i="| ";break}case"indent":case"newline":case"outdent":{i=this.computedIndent,i+=this.pipelessText?this.indentString:"| ";break}}return i+=t.mustEscape?"#":"!",i+=b(this.options.pugBracketSpacing,t.val.trim(),["{","}"]),i}async code(t){let i=this.computedIndent;!t.mustEscape&&t.buffer&&(i+="!"),i+=t.buffer?"=":"-";let e=this.options.pugSemi;e&&(t.mustEscape||t.buffer)&&(e=!1);let n=t.val;try{let s=n;n=await g(n,{parser:"babel",...this.codeInterpolationOptions,semi:e,endOfLine:"lf"}),n=n.slice(0,-1),n[0]===";"&&(n=n.slice(1)),n.includes(`
`)&&(n=s)}catch(s){p.warn("[PugPrinter]:",s)}return i+=` ${n}`,i}id(t){let i=`#${t.val}`;switch(this.currentLineLength+=i.length,this.previousToken?.type){case void 0:case"newline":case"outdent":case"indent":{let e=this.options.pugExplicitDiv?"div":"",n=`${this.computedIndent}${e}${i}`;this.currentLineLength+=e.length,this.result+=n,this.possibleClassPosition=this.result.length;break}default:{let e=this.result.slice(0,this.possibleIdPosition);this.possibleClassPosition+=i.length,this.result=[e,i,this.result.slice(this.possibleIdPosition)].join("");break}}}async"start-pipeless-text"(t){this.pipelessText=!0;let i=`
${this.indentString.repeat(this.indentLevel)}`;if(this.previousToken?.type==="dot"){let e=lt(this.tokens,this.currentIndex),n;switch(e?.val){case"script":{n=Pt(ct(this.tokens,this.currentIndex));break}case"style":{n="css";break}default:break}if(n){let s=this.currentIndex+1,o=this.tokens[s],a="",u=!1;for(;o&&o.type!=="end-pipeless-text";){switch(o.type){case"text":{a+=o.val;break}case"newline":{a+=`
`;break}case"interpolated-code":{u=!0,a+=o.mustEscape?"#":"!",a+=`{${o.val}}`;break}default:{p.warn("[PugPrinter:start-pipeless-text]:","Unhandled token for pipeless script tag:",JSON.stringify(o));break}}s++,o=this.tokens[s]}try{i=await g(a,{parser:n,...this.codeInterpolationOptions})}catch(c){if(!u)throw p.error(c),c;let h=["[PugPrinter:start-pipeless-text]:","The following expression could not be formatted correctly.","This is likely a syntax error or an issue caused by the missing execution context.","If you think this is a bug, please open a bug issue."];h.push(`
code: \`${a.trim()}\``,`
You used interpolated code in your pipeless script tag, so you may ignore this warning.`),Nt.isNativeError(c)?h.push(`
Found ${n} ${c.name}: ${c.message}.`):(p.debug("typeof error:",typeof c),h.push(`
Unexpected error for parser ${n}.`,c)),p.warn(...h),i=a}i=i.trimEnd();let d=this.indentString.repeat(this.indentLevel+1);i=i.split(`
`).map(c=>c?d+c:"").join(`
`),i=`
${i}`,o=this.tokens[s-1],o?.type==="text"&&o.val===""&&(i+=`
`),this.currentIndex=s-1}}return i}"end-pipeless-text"(t){return this.pipelessText=!1,this.pipelessComment=!1,""}doctype(t){let i=`${this.computedIndent}doctype`;return t.val&&(i+=` ${t.val}`),i}dot(t){return"."}block(t){let i=`${this.computedIndent}block `;return t.mode!=="replace"&&(i+=`${t.mode} `),i+=t.val,i}extends(t){return`${this.options.pugSingleFileComponentIndentation?this.indentString:""}extends `}path(t){let i="";return this.checkTokenType(this.previousToken,["include","filter"])&&(i+=" "),i+=t.val,i}"start-pug-interpolation"(t){let i="";return this.pipelessText&&this.tokens[this.currentIndex-2]?.type==="newline"&&this.previousToken?.type==="text"&&this.previousToken.val.trim().length===0&&(i+=this.indentString.repeat(this.indentLevel+1)),this.currentlyInPugInterpolation=!0,i+="#[",i}"end-pug-interpolation"(t){return this.currentlyInPugInterpolation=!1,"]"}interpolation(t){let i=`${this.computedIndent}#{${t.val}}`;return this.currentLineLength+=i.length,this.possibleIdPosition=this.result.length+i.length,this.possibleClassPosition=this.result.length+i.length,i}include(t){return`${this.computedIndent}include`}filter(t){return`${this.computedIndent}:${t.val}`}async call(t){let i=`${this.computedIndent}+${t.val}`,e=t.args;return e&&(e=e.trim().replaceAll(/\s\s+/g," "),e=await g(`x(${e})`,{parser:"babel",...this.codeInterpolationOptions,semi:!1}),e=e.trim().slice(1),i+=e),this.currentLineLength+=i.length,this.possibleIdPosition=this.result.length+i.length,this.possibleClassPosition=this.result.length+i.length,i}async mixin(t){let i=`${this.computedIndent}mixin ${t.val}`,e=t.args;return e&&(e=e.trim().replaceAll(/\s\s+/g," "),e=await g(`function x(${e}) {}`,{parser:"babel",...this.codeInterpolationOptions}),e=e.trim().slice(10,-3),i+=e),i}async if(t){let i=this.computedIndent,e=/^!\((.*)\)$/.exec(t.val);p.debug("[PugPrinter]:",e);let n="if ",s=t.val;return e&&(n="unless ",s=e[1]),i+=n,typeof s=="string"&&(s=await g(s,{parser:"__js_expression",...this.codeInterpolationOptions})),i+=String(s).trim(),i}"mixin-block"(t){return`${this.computedIndent}block`}else(t){return`${this.computedIndent}else`}async"&attributes"(t){let e=`&attributes(${await g(t.val,{parser:"__js_expression",...this.codeInterpolationOptions})})`;return this.currentLineLength+=e.length,e}"text-html"(t){let i=/^<(.*?)>(.*)<\/(.*?)>$/.exec(t.val);if(p.debug("[PugPrinter]:",i),i)return`${this.computedIndent}${i[1]} ${i[2]}`;let e=Object.entries(st).find(([n])=>n===t.val.toLowerCase());return e?`${this.computedIndent}${e[1]}`:`${this.computedIndent}${t.val}`}async each(t){let i=`${this.computedIndent}each ${t.val}`;t.key!==null&&(i+=`, ${t.key}`);let e=await g(t.code,{parser:"__js_expression",...this.codeInterpolationOptions,semi:!1});return i+=` in ${e}`,i}async eachOf(t){let i=t.value.trim();i=await g(i,{parser:"babel",...this.codeInterpolationOptions,semi:!1}),i[0]===";"&&(i=i.slice(1)),i=T(i);let e=await g(t.code,{parser:"__js_expression",...this.codeInterpolationOptions,semi:!0});return e=e.trim(),`${this.computedIndent}each ${i} of ${e}`}async while(t){let i=await g(t.val,{parser:"__js_expression",...this.codeInterpolationOptions});return`${this.computedIndent}while ${i.trim()}`}async case(t){let i=await g(t.val,{parser:"__js_expression",...this.codeInterpolationOptions});return`${this.computedIndent}case ${i.trim()}`}async when(t){let i=await g(t.val,{parser:"__js_expression",...this.codeInterpolationOptions});return`${this.computedIndent}when ${i.trim()}`}":"(t){return this.possibleIdPosition=this.result.length+2,this.possibleClassPosition=this.result.length+2,": "}default(t){return`${this.computedIndent}default`}async"else-if"(t){let i=await g(t.val,{parser:"__js_expression",...this.codeInterpolationOptions});return`${this.computedIndent}else if ${i.trim()}`}blockcode(t){return`${this.computedIndent}-`}yield(t){return`${this.computedIndent}yield`}slash(t){let i="/";return this.nextToken?.type==="text"&&(i+=" "),i}};var v={languages:[{name:"Pug",parsers:["pug"],tmScope:"text.jade",aceMode:"jade",codemirrorMode:"pug",codemirrorMimeType:"text/x-pug",extensions:[".jade",".pug"],linguistLanguageId:179,vscodeLanguageIds:["jade","pug"]}],parsers:{pug:{parse(r,t){p.debug("[parsers:pug:parse]:",{text:r});let i=r.replace(/^\s*\n/,""),e=/^\s*/.exec(i);if(e?.[0]){let o=new RegExp(`(^|\\n)${e[0]}`,"g");i=i.replace(o,"$1")}let n=i,s=Rt(n);return{content:n,tokens:s}},astFormat:"pug-ast",hasPragma(r){return r.startsWith(`//- @prettier
`)||r.startsWith(`//- @format
`)},locStart(r){return p.debug("[parsers:pug:locStart]:",{node:r}),0},locEnd(r){return p.debug("[parsers:pug:locEnd]:",{node:r}),0},preprocess(r,t){return p.debug("[parsers:pug:preprocess]:",{text:r}),r}}},printers:{"pug-ast":{async print(r,t){let i=r.stack[0],{content:e,tokens:n}=i,s=nt(t),a=await new S(e,n,s).build();return p.debug("[printers:pug-ast:print]:",a),a},insertPragma(r){return`//- @prettier
${r}`}}},options:rt,defaultOptions:{}},oi=v.languages,ai=v.parsers,pi=v.printers,li=v.options,ui=v.defaultOptions;export{I as LogLevel,P as Logger,_ as createLogger,ui as defaultOptions,oi as languages,p as logger,li as options,ai as parsers,v as plugin,pi as printers};
//# sourceMappingURL=index.js.map